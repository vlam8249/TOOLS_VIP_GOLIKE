import json
import os,time
import cloudscraper
import requests
import socket
import subprocess
from time import strftime
from time import sleep
from datetime import datetime, timedelta
from bs4 import BeautifulSoup
import time
from colorama import Fore, init
import sys

def kiem_tra_mang():
    try:
        socket.create_connection(("8.8.8.8", 53), timeout=3)
    except OSError:
        print("Máº¡ng khÃ´ng á»•n Ä‘á»‹nh hoáº·c bá»‹ máº¥t káº¿t ná»‘i. Vui lÃ²ng kiá»ƒm tra láº¡i máº¡ng.")

kiem_tra_mang()
scraper = cloudscraper.create_scraper()

from colorama import Fore

banner = f"""
{Fore.YELLOW}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
{Fore.YELLOW}â•‘                                                        â•‘
{Fore.YELLOW}â•‘   \033[38;2;0;120;255mâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     \033[0m{Fore.YELLOW}â•‘
{Fore.YELLOW}â•‘   \033[38;2;0;140;255mâ•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     \033[0m{Fore.YELLOW}â•‘
{Fore.YELLOW}â•‘   \033[38;2;0;160;255m   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     \033[0m{Fore.YELLOW}â•‘
{Fore.YELLOW}â•‘   \033[38;2;0;180;255m   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     \033[0m{Fore.YELLOW}â•‘
{Fore.YELLOW}â•‘   \033[38;2;0;200;255m   â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—\033[0m{Fore.YELLOW}â•‘
{Fore.YELLOW}â•‘   \033[38;2;0;220;255m   â•šâ•â•    â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•\033[0m{Fore.YELLOW}â•‘
{Fore.YELLOW}â•‘                                                        â•‘
{Fore.YELLOW}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
{Fore.WHITE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
{Fore.RED}{Fore.WHITE}PhiÃªn Báº£n: {Fore.YELLOW}TOOL_linkedin_â•‘ ADMIN: \033[38;2;0;220;255mVILÃ‚M
{Fore.WHITE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[{Fore.RED}âš¡{Fore.WHITE}] Zalo: \033[38;2;0;220;255m0368782618
[{Fore.RED}âš¡{Fore.WHITE}] LÆ°u Ã½: \033[38;2;0;220;255mAE dÃ¹ng tool bá»‹ lá»—i thÃ¬ gá»i ADMIN Ä‘á»ƒ sá»­a
{Fore.WHITE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""

os.system('cls' if os.name== 'nt' else 'clear')
print(banner)
sleep(0.5)

    # Nháº­p auth golike
try:
  Authorization = open("Authorization.txt","x")
  t = open("token.txt","x")
except:
  pass
Authorization = open("Authorization.txt","r")
t = open("token.txt","r")
author = Authorization.read()
token = t.read()
if author == "":
  author = input(Colorate.Diagonal(Colors.red_to_green," ğŸ’¸ NHáº¬P AUTHORIZATION GOLIKE : \033[1;33m"))
  token = input(Colorate.Diagonal(Colors.green_to_red,"ğŸ’¸  NHáº¬P TOKEN (T Cá»¦A GOLIKE): \033[1;33m"))
  Authorization = open("Authorization.txt","w")
  t = open("token.txt","w")
  Authorization.write(author)
  t.write(token)
else:
  console = Console()
  menu_text = Text()
  menu_text.append("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n", style="bold red")
  menu_text.append("â•‘      [1] VÃ o Tool GoLike              â•‘\n", style="bold white")
  menu_text.append("â•‘      [2] Nháº­p Auth Golike Má»›i         â•‘\n", style="bold white")
  menu_text.append("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•", style="bold red")

  console.print(Panel(menu_text, title="? MENU GOLIKE", border_style="bright_red"))

  select = console.input("[bold yellow]? Nháº­p lá»±a chá»n [1/2]: [bold green]").strip()

  kiem_tra_mang()
  if select != "1":
    author = select
  if select == "2":
    for i in range(1, 101):
     sys.stdout.write(f"\r{BOLD}{AQUA} ÄANG TIáº¾N HÃ€NH XÃ“A AUTH CÅ¨ : [{i}% {'â•‘' * (i // 2)}]{RESET}")
     sys.stdout.flush()
     sleep(0.03)  # Äiá»u chá»‰nh thá»i gian chá» náº¿u cáº§n
    os.system('cls' if os.name== 'nt' else 'clear')
    print(banner)
    author = input("\033[1;33mNháº­p Auth Golike Má»›i : ")
    token = input("\033[1;32mNháº­p T Golike Má»›i : \033[1;33m")
    Authorization = open("Authorization.txt","w")
    t = open("token.txt","w")
    Authorization.write(author)
    t.write(token)
Authorization.close()
t.close()
os.system('cls' if os.name== 'nt' else 'clear')
banner()
headers = {
    'Accept': 'application/json, text/plain, */*',
    'Content-Type': 'application/json;charset=utf-8',
    'Authorization': author,
    't': token,
    'User-Agent': 'Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Mobile Safari/537.36',
    'Referer': 'https://app.golike.net/account/manager/linkedin',
}

scraper = cloudscraper.create_scraper()
def chonacc():
    json_data = {}
    try:
      response = scraper.get(
        'https://gateway.golike.net/api/linkedin-account',
    
        headers=headers,
        json=json_data
     ).json()
      return response
    except Exception:
      sys.exit()

def nhannv(account_id):
    try:
        params = {
            'account_id': account_id,
            'data': 'null',
        }
   
        response = scraper.get(
            'https://gateway.golike.net/api/advertising/publishers/linkedin/jobs',
            headers=headers,
            params=params,
            json={}
        )
        return response.json()
    except Exception:
      sys.exit()

def hoanthanh(ads_id, account_id):
    try:
        json_data = {
            'ads_id': ads_id,
            'account_id': account_id,
            'async': True,
            'data': None,
        }

        response = scraper.post(
            'https://gateway.golike.net/api/advertising/publishers/linkedin/complete-jobs',
            headers=headers,
            json=json_data,
            timeout=6
        )
        return response.json()
    except Exception:
      sys.exit()

def baoloi(ads_id, object_id, account_id, loai):
    try:
        json_data1 = {
            'description': 'TÃ´i Ä‘Ã£ lÃ m Job nÃ y rá»“i',
            'users_advertising_id': ads_id,
            'type': 'ads',
            'provider': 'tiktok',
            'fb_id': account_id,
            'error_type': 6,
        }

        scraper.post('https://gateway.golike.net/api/report/send', headers=headers, json=json_data1)

        json_data2 = {
            'ads_id': ads_id,
            'object_id': object_id,
            'account_id': account_id,
            'type': loai,
        }

        scraper.post(
            'https://gateway.golike.net/api/advertising/publishers/linkedin/skip-jobs',
            headers=headers,
            json=json_data2,
        )
    except Exception:
      sys.exit()

console = Console()
chontktiktok = chonacc()
def dsacc():
    if chontktiktok.get("status") != 200:
        console.print(Panel("[red]âŒ Authorization hoáº·c Token sai![/red]\n[bold yellow]Vui lÃ²ng kiá»ƒm tra láº¡i file Auth.txt & token.txt[/bold yellow]", title="Lá»—i xÃ¡c thá»±c", border_style="red"))
        sys.exit(1)

    table = Table(title="ğŸ“± DANH SÃCH ACC", box=box.ROUNDED, border_style="bold green")
    table.add_column("STT", justify="center", style="bold cyan")
    table.add_column("TÃªn TÃ i Khoáº£n", style="bold magenta")
    table.add_column("Tráº¡ng thÃ¡i", style="bold green")

    for i, acc in enumerate(chontktiktok["data"], start=1):
        nickname = acc.get("name", acc.get("name", "KhÃ´ng tÃªn"))
        status = "Online" if acc.get("status") == 1 else None  
        table.add_row(str(i), nickname, status)

    console.print(table)

# Hiá»ƒn thá»‹ danh sÃ¡ch acc
dsacc()

# Nháº­p lá»±a chá»n acc
while True:
    try:
        luachon = int(input("\033[1;31mChá»n tÃ i khoáº£n : \033[1;33m"))
        if 1 <= luachon <= len(chontktiktok["data"]):
            account = chontktiktok["data"][luachon - 1]
            account_id = account["id"]
            account_nickname = account.get("nickname", account.get("name", "KhÃ´ng tÃªn"))
            break
        console.print("[red]âš ï¸ Acc khÃ´ng cÃ³ trong danh sÃ¡ch. Nháº­p láº¡i![/red]")
    except Exception as e:
        console.print(f"[red]âŒ Sai Ä‘á»‹nh dáº¡ng! {str(e)}[red]")

console.print(f"[yellow]Delay Ä‘Ã£ dc setup!")
# Hiá»ƒn thá»‹ loáº¡i nhiá»‡m vá»¥
nhiem_vu_panel = Panel.fit(
    "[bold cyan]ğŸ”° CHá»ŒN LOáº I NHIá»†M Vá»¤[/bold cyan]\n"
    "[bold green][1][/bold green] Thá»±c hiá»‡n NV Follow â•",
    title="ğŸ¯ Menu Nhiá»‡m Vá»¥", border_style="bright_blue"
)
console.print(nhiem_vu_panel)
while True:
    try:
        loai_nhiem_vu = IntPrompt.ask("[bold yellow]ğŸ‰ Chá»n loáº¡i nhiá»‡m vá»¥ cáº§n kiáº¿m tiá»n", default=1)
        if loai_nhiem_vu == 1:
            break
        else:
            console.print("[red]âš ï¸ Hiá»‡n táº¡i chá»‰ cÃ³ nhiá»‡m vá»¥ [1] Follow![red]")
    except:
        console.print("[red]âŒ Sai Ä‘á»‹nh dáº¡ng! Vui lÃ²ng nháº­p sá»‘.[/red]")

  
# ThÃªm pháº§n chá»n loáº¡i nhiá»‡m vá»¥ sau khi chá»n tÃ i khoáº£n vÃ  trÆ°á»›c khi báº¯t Ä‘áº§u lÃ m nhiá»‡m vá»¥


dem = 0
tong = 0
max_retries = 3
retry_count = 0
nhanjob = None
dsaccloi = []
accloi = ""
os.system('cls' if os.name== 'nt' else 'clear')

banner()
print("")

console = Console()

def nhan_tien_progress(account_id, ads_id, object_id, job_type):
    console.print("[bold cyan]ğŸ’¸ Äang tiáº¿n hÃ nh nháº­n xu tá»« GoLike...[/bold cyan]\n")

    with Progress(
        SpinnerColumn(style="bold yellow"),
        TextColumn("[progress.description]{task.description}", style="bold white"),
        BarColumn(bar_width=40, complete_style="green"),
        TimeElapsedColumn(),
        transient=True
    ) as progress:
        task = progress.add_task("ğŸª™ Äang nháº­n xu", total=100)
        for _ in range(100):
            progress.update(task, advance=1)
            time.sleep(0.015)

    console.print("[bold green]âœ… Nháº­n xu thÃ nh cÃ´ng![/bold green]\n")


dem = 0
tong = 0
console = Console()

while True:
    # TÃ¬m job
    retry_count = 0
    max_retries = 4
    nhanjob = None

    while retry_count < max_retries:
        try:
            nhanjob = nhannv(account_id)
            if nhanjob and nhanjob.get("status") == 200 and nhanjob["data"].get("link") and nhanjob["data"].get("object_id"):
                break
        except:
            pass
        retry_count += 1
        time.sleep(1.5)

    # KhÃ´ng láº¥y Ä‘Æ°á»£c job
    if not nhanjob or retry_count >= max_retries:
        console.print("[red]âŒ KhÃ´ng láº¥y Ä‘Æ°á»£c job, thá»­ láº¡i...[/red]")
        time.sleep(2)
        continue

    # Láº¥y thÃ´ng tin job
    ads_id = nhanjob["data"]["id"]
    link = nhanjob["data"]["link"]
    object_id = nhanjob["data"]["object_id"]
    job_type = nhanjob["data"]["type"]

    # Kiá»ƒm tra loáº¡i job cÃ³ Ä‘Ãºng yÃªu cáº§u khÃ´ng
    if (loai_nhiem_vu == 1 and job_type != "follow") or \
       (loai_nhiem_vu == 2 and job_type != "like") or \
       (job_type not in ["follow", "like"]):
        baoloi(ads_id, object_id, account_id, job_type)
        continue

    # Má»Ÿ link job (náº¿u cáº§n: webbrowser.open(link) hoáº·c ADB)

    # Countdown
    def countdown(delay):
        spinner = ["|", "/", "-", "\\"]
        with Live(refresh_per_second=10) as live:
            for i in range(delay, -1, -1):
                color = "bold magenta" if i % 2 == 0 else "bold green"
                spin = spinner[i % len(spinner)]
                text = Text(f"â³ {spin} Delay chá»‘ng block | {i}s", style=color)
                panel = Panel(text, title="Äáº¿m ngÆ°á»£c", border_style=color)
                live.update(panel)
                sleep(1)
            live.update(Panel(Text("ğŸš€ Báº¯t Ä‘áº§u!", style="bold bright_green"), title="Xong!", border_style="bold white"))

    countdown(random.randint(10, 20))  # Random delay chá»‘ng block

    # Gá»­i xÃ¡c nháº­n hoÃ n thÃ nh job
    nhantien = None
    for attempt in range(2):
        try:
            nhantien = hoanthanh(ads_id, account_id)
            if nhantien and nhantien.get("status") == 200:
                break
        except:
            pass
        time.sleep(1)

    if nhantien and nhantien.get("status") == 200:
        # Hiá»‡u á»©ng nháº­n xu
        def nhan_tien_progress():
            with Progress(
                SpinnerColumn(style="bold yellow"),
                TextColumn("[progr
